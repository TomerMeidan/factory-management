<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Employees</title>
    <style>
      table,
      th,
      td {
        border: 1px solid black;
      }
    </style>
  </head>
  <body onload="editEmployeeHandler()">
    <h1>Factory Management Site</h1>
    <button onclick="location.href = '../pages/welcome.html';">Homepage</button>
    <button>Departments</button>
    <button>Shifts</button>
    <button>Users</button>
    <button>Logout</button>
    <h3 id="user-name"></h3>

    <!--  TODO Use sessionStorage to store the selected person from employees page -->

    First Name: <input type="text" id="firstName" value="John" /> <br /><br />
    Last Name: <input type="text" id="lastName" value="Doe" /> <br /><br />
    Start Work Year: <input type="text" id="startWorkYear" value="2019" />
    <br /><br />
    Department Name: <input type="text" id="department" value="Marketing" />
    <br /><br />
    <!-- TODO Shifts table -->

    <button>Update</button>

    <button>Delete</button>

    <script>

        
      async function editEmployeeHandler() {
        const id = sessionStorage["editEmployeeID"];

        const response = await fetch(`http://localhost:3000/employees/edit/${id}`, {
          method: "GET",
        });
        const user = await response.json();

        let firstName = document.getElementById("firstName");
        let lastName = document.getElementById("lastName");
        let startWorkYear = document.getElementById("startWorkYear");
        let department = document.getElementById("department");
        
        firstName.value = user.firstName
        lastName.value = user.lastName
        startWorkYear.value = user.startWorkYear
        department.value = user.departmentID.name

        console.log(response);
      }

      async function getAllUsersHandler() {
        const response = await fetch(`http://localhost:3000/employees/edit/`, {
          method: "GET",
        });
        const user = await response.json();

        // TODO Use session to store the incoming user data
        const name = sessionStorage["name"];
        const welcome = (document.getElementById(
          "user-name"
        ).innerText = `Welcome, ${name || ""}`);
        console.log(data);
      }
    </script>
  </body>
</html>
